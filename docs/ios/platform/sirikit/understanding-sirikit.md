---
title: 了解 SiriKit 概念
description: 本文档介绍在 Xamarin.iOS 应用程序中使用 SiriKit 所需的关键概念。 例如，它讨论意向和意向 UI 扩展，SiriKit 权限设计更完美的体验，和的详细信息。
ms.prod: xamarin
ms.assetid: 99EC5C1E-484F-4371-8555-58C9F60DE37F
ms.technology: xamarin-ios
author: bradumbaugh
ms.author: brumbaug
ms.date: 05/02/2017
ms.openlocfilehash: 62b612f2e2725e5856a39e1d4d3fc1288282167a
ms.sourcegitcommit: ea1dc12a3c2d7322f234997daacbfdb6ad542507
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/05/2018
ms.locfileid: "34788925"
---
# <a name="understanding-sirikit-concepts"></a>了解 SiriKit 概念

_本文介绍如何将需要在 Xamarin.iOS 应用程序中使用 SiriKit 的关键概念。_


新 SiriKit 到 iOS 10，允许 Xamarin.iOS 应用程序提供的 iOS 设备上使用 Siri 和映射的应用程序向用户访问服务。 此功能提供一个或多个应用程序扩展中使用新**意向**和**意向 UI**框架。

SiriKit 允许 iOS 应用程序提供使用应用程序扩展和新的 iOS 设备上使用 Siri 和映射的应用程序的用户可以访问的服务**意向**和**意向 UI**框架。

Siri 配合的概念**域**，组知道相关任务的操作。 该应用程序可以使用 Siri 与每个交互必须划分为其已知的服务域之一，如下所示：

- 音频或视频的调用。
- 预订持续一段时间。
- 管理锻炼。
- 消息传递。
- 搜索照片。
- 发送或接收付款。

当用户进行的请求 Siri 涉及应用扩展的服务之一时，SiriKit 发送扩展**意向**描述以及任何支持的数据的用户的请求的对象。 然后，应用扩展生成相应**响应**对象给定**意向**，详细介绍如何扩展可以处理该请求。

## <a name="the-intents-and-intents-ui-extensions"></a>意向和意向 UI 扩展

Siri 和映射的应用程序与通过两种不同类型的应用程序扩展的应用程序的服务进行交互：

- **意向扩展**-提供 Siri 和与该应用程序的映射的内容并执行完成任何受支持的方法所需的任务。
- **意向 UI 扩展**-内 Siri 或映射的应用程序的内容中提供的自定义的用户界面将显示。

应用程序必须提供要支持 SiriKit 的意向扩展，它负责提供 Siri 和映射可以向用户显示的信息并处理意向。

创建意向 UI 扩展是可选的因为 Siri 通常处理所有用户交互，并且具有标准的内置 UI 呈现在每个受支持的域的信息。 通过提供意向 UI 扩展，该应用程序可以使用**意向 UI** framework 提供丰富、 自定义用户界面采用应用程序的品牌和其他信息。

## <a name="siri-and-the-maps-app-role"></a>Siri 和地图应用程序角色

用户的口头的请求进行处理，在语义上分析 Siri 可将转换可操作意向意向扩展可以处理这些请求的语言。

Maps 使用应用程序的意向扩展来在对用户的操作的响应中的映射界面中显示信息。 如附近的餐馆请求或获取应用程序的餐馆评审。

Siri 和映射管理所有用户的交互，并显示结果使用标准系统接口。 应用程序扩展角色主要是为了提供获取显示的数据。 （可选） 应用程序能提供意向 UI 扩展，显示用于增强默认系统接口的自定义 UI。

## <a name="interacting-with-siri-via-sirikit"></a>与通过 SiriKit Siri 交互

本部分将显示 SiriKit 如何允许用户与使用 Siri 对应用进行交互的概述。 对于此示例中，我们将使用假 MonkeyChat 应用：

[![](understanding-sirikit-images/monkeychat01.png "MonkeyChat 图标")](understanding-sirikit-images/monkeychat01.png#lightbox)

MonkeyChat 能让用户的朋友自己联系人簿，每个与屏幕名称 （如 Bobo 例如)，并允许用户将文本聊天发送到每个友元，按用户屏幕的名称。

有多种方法，因为不同的人可能在多种不同的形式发出相同请求，用户可能会启动应用时，交互。

例如，如果用户想要将消息发送到其友元 Bobo，它们可能具有 Siri 的以下会话：

_用户： 你好 Siri，发送 MonkeyChat 消息。_<br />
_Siri： 向其？_<br />
_用户： Bobo。_<br />
_Siri： 你想什么说到 Bobo？_<br />
_用户： 请自动发送详细香蕉。_<br />

其他人可能会使与不同对话的同一请求：

_用户： 向 Bobo MonkeyChat 上发送消息。_<br />
_Siri： 你想什么说到 Bobo？_<br />
_用户： 请自动发送详细香蕉。_<br />

和其他用户可能会使甚至更短的请求：

_用户： MonkeyChat Bobo 请发送详细香蕉。_<br />
_Siri： 好了，发送消息请详细香蕉向发送 Bobo Monkeychat 上。_<br />

或甚至以不同语言中发出相同请求：

_用户： MonkeyChat Bobo s'il vous plaît envoyer 加上 de bananes。_<br />
_Siri: Oui、 envoi 消息 s'il vous plaît envoyer 加 de bananes à Bobo sur Monkeychat。_<br />

尚未另一个用户可能非常详细其对话中：

_用户： 你好 Siri，可以将请我优先而是启动 MonkeyChat 应用程序来发送消息文本请自动发送详细香蕉。_<br />
_Siri： 向其？_<br />
_用户： 我最佳 pal Bobo。_<br />

此外，有 Siri 可能响应请求，某些基于如何发出请求的多种方法：

- **通过按住主页按钮**-Siri 将提供有限的口头反馈的更多 visual 响应。
- **通过"您好 Siri"** -Siri 将更口头并提供较少 visual 响应。

Siri 也进行调整以满足用户的可访问性需求，并将进行交互和响应根据这些需求。

如何发出请求，或使用 Siri 如何响应的请求，无论使用 Siri 处理与用户会话并 （通过其扩展） 应用程序提供的功能。

当用户进行时使用 Siri 的口头请求时，这些是 Siri 将遵循的步骤：

[![](understanding-sirikit-images/monkeychat02.png "Siri 将遵循的步骤")](understanding-sirikit-images/monkeychat02.png#lightbox)

1. 首先，使用 Siri 采用用户的音频**语音**并将其转换成文本。
2. 接下来，将文本转换为**意向**、 结构化表示形式的用户的请求。
3. 基于的目的，将需要使用 Siri**操作**执行用户的请求。
4. 最后，将显示使用 Siri**响应**（visual 和口头） 向用户基于执行的操作。

有应用程序可以拍摄一部分 Siri 与用户的会话中的三个方面：

[![](understanding-sirikit-images/monkeychat03.png "应用程序可能需要使用 Siri 用户会话中的一部分三种主要方法")](understanding-sirikit-images/monkeychat03.png#lightbox)

1. **词汇**-这是应用程序如何告知 Siri 需要知道可以与其进行交互的单词。
2. **应用程序逻辑**-这些是操作和应用程序需要较长的响应基于给定意向。
3. **用户界面**-这是应用程序可让其响应中的可选的自定义用户界面。

### <a name="example"></a>示例

根据上述信息，检查以下会话将如何与 MonkeyChat 应用进行交互：

_用户： 你好 Siri，发送一条消息到 Bobo MonkeyChat 上。_<br />
_Siri： 你想什么说到 Bobo？_<br />
_用户： 请自动发送详细香蕉。_<br />

应用程序设置将在会话中的第一个角色是帮助了解用户的语音的 Siri:

[![](understanding-sirikit-images/monkeychat04.png "帮助了解用户语音使用 Siri")](understanding-sirikit-images/monkeychat04.png#lightbox)

Siri 不具有名称"Bobo"在其数据库中，但应用程序未且已通过其词汇 Siri 通过共享此信息。 应用程序还有助于识别 Bobo 是否收件人，因为它指定到 Siri 作为它们的使用 Siri*联系人*。

Siri 知道的详细信息需要可以发送只接收方比消息，因此它将快速检查消息是否需要内容了应用程序扩展。 原因是 MonkeyChat，Siri 将响应与问题用户： *"你想什么说到 Bobo？"*

在上面的示例中，用户已做出响应， *"请自动发送详细香蕉"*，其中使用 Siri 将捆绑到一种结构化**意向**:

[![](understanding-sirikit-images/monkeychat05.png "Siri 将捆绑为结构化的意图的用户的响应")](understanding-sirikit-images/monkeychat05.png#lightbox)

结构化的意向将包含以下信息：

- **域：** 消息
- **意向：** sendMessage
- **收件人：** Bobo
- **内容：** 请自动发送详细香蕉

作为一组的每个域都有知道*操作*零到多个参数可能包括在意图，都可以在其中执行，并可以根据域和操作，发送到应用。

意图然后发送到应用程序扩展处理。 应用程序在处理意图，生成因此**IntentResponse**它将与意图捆绑并包括描述要应用应用程序未使用意向的参数。

每个 IntentResponse 还将包括**响应代码**以通知应用程序是否能够完成请求，或不使用 Siri。 某些域具有也会发送的非常具体的错误响应代码。

最后，将包括 IntentResponse `NSUserActivity` （如那些用于提交支持）。 `NSUserActivity`将用于启动应用程序，如果响应需要它们保持 Siri 环境，然后输入应用程序以完成它。 

Siri 将自动生成适当`NSUserActivity`以启动应用程序和拾取用户离开的位置在 Siri 环境中。 但是，应用程序可提供其自己`NSUserActivity`自定义信息，如有必要。

应用程序处理意向，并返回对使用 Siri 的响应后，然后将其提供结果向用户 （通过口头方式和以可视方式）：

[![](understanding-sirikit-images/monkeychat06.png "同时通过口头方式直观地向用户显示结果")](understanding-sirikit-images/monkeychat06.png#lightbox)

Siri 为每个可用于应用的域有几个内置响应用户界面。 但是，由于 MonkeyChat 已提供一个可选的意向 UI 扩展，因此它用于在上面的示例中向用户显示结果的会话。

## <a name="the-intent-lifecycle"></a>意向的生命周期

有三个应用扩展将需要执行意向在处理时的主要任务：

[![](understanding-sirikit-images/monkeychat07.png "意向的生命周期")](understanding-sirikit-images/monkeychat07.png#lightbox)

1. 应用程序必须**解决**事件的每个参数。 因此，应用程序将调用解决多次 （每一次每个参数），并有时多次为同一参数直到应用和用户正在请求上达成一致。
2. 应用程序必须**确认**它可以处理的请求的意图并使用 Siri 告诉预期的结果。
3. 最后，应用程序必须**处理**意图和执行的步骤来实现请求的结果。

### <a name="the-resolve-stage"></a>解决阶段

解决阶段帮助了解用户已提供，并确保用户所做实际上意味着意图处理应用程序时将发生的值时使用 Siri。 

此阶段还提供了应用程序以与用户在对话期间影响 Siri 的行为有机会。 若要执行此操作，该应用将提供**解析响应**。 有多种不同类型的数据使用 Siri 理解的预定义响应。

最常见的应用中的解析响应将**成功**，这意味着应用程序到它所知道的信息片段 （如用户屏幕名称） 参数从匹配特定的数据片段。

可能的应用需要确认给定的请求匹配的正确条它就会了解有关的信息的时间。 在这些情况下，它将发送**ConfirmationRequired**响应提问是或否向用户如 *"发送消息到 Bobo 出色？"*

可能有其他情况下，将需要应用的用户从选项的简短列表中选取。 在这种情况下，应用程序将提供**消除歧义**响应，其中用户可以选择从如到十个两个选项的列表： 

```csharp
Who do you want to message?

* Bobo the Great
* Bobo Jr.
* Little Bobo
```

Siri 将处理发出所选内容，通过口头方式或通过使用 Siri 用户界面时，进行交互的用户，并且结果将发送回应用程序。

在其他情况下，可能没有足够的信息的应用程序来解决参数或可能有太多的匹配项，若要解决使用消除歧义 （如其名称中具有 Bobo 80 用户）。 在这种情况下，应用程序将发送**NeedsMoreDetails**响应和 Siri 将提示用户使其更具体。

如果用户未提供到进程意图使其所需的值，它可发送**NeedsValue**响应具有 Siri 提示用户输入值。

如果应用程序不支持用户授予特定参数的一个值，它可发送**UnsupportedWithReason**响应可以提供相应原因，为什么不支持的值。 Siri 然后将提示用户输入一个全新的值给定它们原因需要它的和。

最后使用**NotRequired**响应，告知 Siri 应用程序不需要为给定的参数的值。 如果用户仍提供一个，Siri 将只是被忽略。

### <a name="the-confirm-stage"></a>确认阶段

确认阶段有两个用途：

- 若要告诉 Siri 处理为打算，以便使用 Siri 可以告知用户即将发生的预期的结果。
- 提供程序有机会检查任何应用程序可能需要完成该请求由用户，例如银行进行请求的付款中具有足够的钱的所需的状态。

应用程序将提供**意向响应**确认步骤中，应将使用的填充多应用程序的信息已可用，以便使用 Siri 能够它有效地与用户。

基于域和操作类型，使用 Siri 可能会提示用户进行确认，如之前发送付款或预订持续一段时间。

### <a name="the-handle-stage"></a>句柄阶段

处理阶段是使用为打算，因为它是应用程序通过执行的任务已被要求为满足用户的请求的位置的点的最重要的部分。

就像它未在确认阶段中，应用程序将需要提供可能的结果一样多的信息，以便使用 Siri 可以与此用户。 有时将直观地显示此信息也在其他时候，使用 Siri 将返回给用户只需朗读。 

当应用程序可能需要额外的时间来处理给定的请求，如网络调用延迟或实时的用户需要完成请求 （如完成和传送订单或一辆汽车推向用户的位置），则可能存在时间。 如果使用 Siri 正在等待从应用程序返回的响应，它将向用户告知应用程序正在处理请求显示等待 UI。

理想情况下，应用程序应提供响应 Siri 在两到三秒内最多。 如果应用已知道，给定的响应将到进程花费的时间，它必须发送**InProgress**响应代码，以便使用 Siri。 Siri 随后会告知用户应用程序正在处理在后台请求，并将继续为此，即使他们离开 Siri 环境。

## <a name="adding-sirikit-to-the-app"></a>将 SiriKit 添加到应用程序

在 iOS 10 SiriKit，与 Apple 已创建两个新的扩展点：

- **意向扩展**-Siri 提供应用程序的内容，并执行完成任何受支持的方法所需的任务。
- **意向 UI 扩展**-Siri 内的应用程序内容中提供的自定义的用户界面将显示。 

此外还有一个 API，用于向使用 Siri 以帮助识别的形式提供的单词和短语：

- **应用词汇**的单词和短语所共有的应用程序的每个用户。
- **用户词汇**的单词和短语的给定的应用用户是唯一的。

## <a name="the-intents-extension"></a>意向扩展

意向扩展负责处理应用程序，并使用 Siri 之间的主要交互，如下所示：

[![](understanding-sirikit-images/intents01.png "意向扩展")](understanding-sirikit-images/intents01.png#lightbox)

意向扩展插件可以支持一个或多个方法，它是由开发人员决定客户想要在应用程序中实现 SiriKit。 有关无需处理每个目的，开发人员还可以添加单独的意向扩展。  也就是说，Apple 请求，以便使用 Siri 没有针对应用程序中，打开需要更多的内存和时间来处理多个进程，开发人员，限制的意向扩展名的数量。

开发人员还应当注意时处于活动状态时使用 Siri 意向扩展，将在后台运行。 这允许使用 Siri 主动执行上与用户与扩展以处理有关请求的信息仍通信时的对话。

## <a name="privacy-and-security-considerations"></a>隐私和安全注意事项

Apple 已采取很好的措施，以确保私有时使用 Siri 信息安全，并且在这种情况下，有几个要求用户在 iOS 设备上登录的交互用户。 例如，当请求持续一段时间或付款的。

此外，还有一些应用程序可能要将限制为正在登录到设备的用户的特定行为。 对于这些情况下，应用程序可以请求**限制时锁定**行为。 这通过中的设置完成`Info.plist`文件。

本地身份验证框架仅供意向扩展应用程序可以要求用户输入附加身份验证信息，因此即使该设备已解锁。

最后，Apple Pay 是可用于目的扩展的因此应用程序可以完成事务使用 Apple Pay 和内置的 Apple Pay 表将显示高于 Siri 接口。

此外，Apple 希望确保用户知道当它们正在送入信息与第三方应用程序在这种情况下，用户**必须**时说出特定名称 （在应用的捆绑包显示名称中指定） 的应用程序发出请求。

Apple 具有专门设计 Siri 执行自然流体对话与用户，因此，应用程序的包名称可在许多词类，只要它适合自然中用户的请求。

用户将执行的常见项目之一是"verbify"应用程序的名称，换而言之，使应用程序名称，并将其作为在请求中的谓词。 例如， *"MonkeyChat Bobo 这些都很好香蕉。"*

## <a name="the-intents-ui-extension"></a>意向 UI 扩展

意向 UI 扩展提供了机会来使应用程序的 UI 和品牌到 Siri 体验，并使用户感到连接到应用程序。 通过此扩展的品牌以及到该脚本的 visual 和其他信息，可以将应用程序。

[![](understanding-sirikit-images/intents02.png "示例意向 UI 扩展输出")](understanding-sirikit-images/intents02.png#lightbox)

将始终返回意向 UI 扩展`UIViewController`和应用程序可以添加任何内容它喜欢内的视图控制器，如超出初始响应的显示其他信息。 意向 UI 还可以使用长时间运行的事件，如多少就越长共享来访问其位置的汽车持续一段时间的状态更新用户。

意向 UI 扩展将始终显示以及其他使用 Siri 内容，例如应用程序图标和 UI 顶部的名称或，基于的目的，可能在底部显示按钮 （如发送或取消）。

有少数情况下应用程序可以在其中替换 Siri 向用户显示默认情况下，如消息传递或映射其中应用程序可以将默认值体验，替换为一个适合应用程序的信息。

> [!IMPORTANT]
> 尽管很可能如添加交互元素`UIButtons`或`UITextFields`意向 UI 扩展到`UIViewController`、 这些严格禁止作为中非交互式的意向 UI 和用户将不能与它们进行交互。

它是完全可选的应用程序以提供意图 UI 扩展，因为 Siri 包含一组默认的用户界面为每个意向的类型。 此外，接口意向 UI 才可用对于某些意向 Apple 具有认为将对用户有用。

## <a name="adding-sirikit-vocabulary"></a>添加 SiriKit 词汇

最后一段实现 SiriKit 介于在应用内通过提供所需的词汇。 许多应用程序具有信息的用户和用户将提供向应用程序的信息的唯一方式进行说明的唯一的方式。

因此，使用 Siri 需要应用程序的帮助，以了解单词和短语唯一的应用程序。 某些这些短语将为应用程序部分，以便每个用户将知道和了解这些。 尚未其他人将是唯一的给定用户的应用程序。

### <a name="app-specific-vocabulary"></a>特定于应用程序词汇

应用程序特定词汇到的所有应用程序的用户，如车辆类型或锻炼名称定义的特定的词和短语将已知的。 因为这些是应用程序的一部分，它们在定义`AppIntentVocabulary.plist`文件作为主应用捆绑包的一部分。 此外，还应本地化这些词和短语。

有几个部分词汇`AppIntentVocabulary.plist`文件：

- **示例应用程序使用**-这些用户可以进行的应用程序的请求提供一套常见用例。 例如： *"开头锻炼 MonkeyFit。"*
- **参数**-这些提供一组特定于应用的非标准的参数类型。 例如，MonkeyFit 应用的锻炼名。 这些包括：
    - **短语**-允许应用程序定义应用程序的唯一字词。 例如： MonkeyFit 应用的"Bananarific"锻炼类型。 
    - **发音**-为给定的短语简单拼音赋予 Siri 发音提示。 例如，"ba nana ri fic"。
    - **示例**-提供了在应用程序中使用给定的短语的一个示例。 例如， *"启动 Bananarific 中 MonkeyFit"*。

有关详细信息，请参阅 Apple 的[应用词汇文件格式引用](https://developer.apple.com/library/prerelease/content/documentation/Intents/Conceptual/SiriIntegrationGuide/CustomVocabularyKeys.html#//apple_ref/doc/uid/TP40016875-CH10-SW1)。

### <a name="user-specific-vocabulary"></a>用户特定词汇

用户特定词汇即将提供词或短语是唯一的应用程序的单个用户。 作为排序中最重要的使用情况优先级对于用户来说，在列表的开头的最重要条款的条款的有序集，将在运行时从主应用程序 （不应用程序扩展名） 提供这些。

看一看上面介绍的 MonkeyChat 应用示例。 MonkeyChat 保留的所有用户的联系人，它将发送到通过用户特定词汇 Siri 的列表。 它还保留用户具有消息按原样 10 个最新联系人的列表，它具有一套收藏夹联系人的每个用户。 对于此示例中，重要的联系人应该是在开始时我们用户特定词汇，跟最新的联系人然后用户的联系人的其余部分。

用户特定词汇支持以下类型的信息：

- 联系人姓名。
- 测验名称。
- 照片唱片集名称。
- 照片的关键字。

如果应用程序依赖于 iOS 通讯簿，应用程序将不需要执行任何操作，因为此信息已可供使用 Siri。 应用程序只需提供联系人姓名，如果应用具有其自己的联系人的唯一数据库。

在设计时词汇，仅提供必要的值，用户知道和关注。 避免提供信息，例如电话号码或电子邮件地址。

应用程序还需要用户特定词汇更改时立即更新使用 Siri。 用户已经习惯于请求信息从 Siri 已添加到其 iOS 设备的时刻。 例如，如果用户在应用程序中添加新联系人，将发送该信息到 Siri 一旦用户将其保存。

更重要的是，应用_必须_删除信息从 Siri 词汇立即因为如果删除一条信息，这些文件，但使用 Siri 已仍识别它小时或天后，用户可能会变得令感到不安。

> [!IMPORTANT]
> 应用程序应从删除所有用户特定词汇 Siri 如果用户选择重置应用程序，或如果它们注销。

## <a name="sirikit-permissions"></a>SiriKit 权限

最后一段 SiriKit 围绕权限。 就像使用其他功能 （例如照片、 相机或联系人） iOS，用户必须授予应用程序以与 Siri 交流的显式权限。

该应用是能够提供一个定义哪些信息，它将提供给 Siri 并给出有关为什么用户应授予此访问权限的原因的字符串。 

Apple 提供的建议应用程序应从要使用 Siri 第一个时间它们在升级到 iOS 10 后，在用户打开应用程序的用户请求权限。 这可以确保用户了解使用 Siri 集成和他们在进行其第一个请求前可以预先批准的使用情况。

## <a name="sirikit-and-maps"></a>SiriKit 和映射

SiriKit 是不可或缺的组成部分 iOS 并使用较大的意向框架添加到 iOS 10。 意向 framework 旨在与系统的其他部分共享常见和共享的操作和意向。

意向框架体现在只需使用 Siri 集成，并提供其他功能，如联系人集成其中应用程序可能会默认电话服务或特定联系人的消息传送应用程序。 意向还提供与 CallKit 为用户提供最佳 VOIP 体验深度集成。

在 iOS 10 地图应用程序已添加功能，如持续一段时间共享用户可以在其中预订直接内地图 UI 持续一段时间。 SiriKit 提供与地图的常见扩展点，因此可以使用 Siri 和地图之间共享持续一段时间共享 （和其他） 意向。 

这意味着，如果应用程序已采用 SiriKit 扩展，它将还可以获取地图集成免费。 

## <a name="designing-a-great-siri-experience"></a>设计卓越的 Siri 体验

设计出色的用户体验时将应用程序集成到 Siri 是不同于设计出色的应用用户界面。 与不同的是正常情况下，其中在用户交互与直接在应用屏幕上，存在使用 Siri 时很多时候时没有可视化界面始终可见。 例如，当用户已开始的会话 *"您好 Siri"*。

### <a name="how-siri-helps-the-developer"></a>如何使用 Siri 帮助开发人员

在设计时使用 Siri 的应用程序的交互，将生成应用程序*会话接口*，这意味着上下文派生从 Siri 时遇到与应用程序的代表用户的会话。

在没有的视觉参考的情况下，用户必须跟踪的要呈现在其头中的信息。 因此，使用 Siri 显示裸机最小所需的信息来完成任务的用户希望完成。

会话的接口是受影响的问题和响应的用户和 Siri 从在对话期间。 因此请务必考虑如何使用 Siri 会询问一些问题以及时设计此接口的响应。

执行下面的示例创建一条消息，使用这一问题，可能会响应 Siri 的用户 *"已准备好将其发送？"*. 用户无法响应以多种不同方式如 *"发送"*， *"取消"* 或甚至事物完全不相关的对此问题。 无论如何会话播放时，使用 Siri 将处理对于应用，并仅将其发送的相关信息变得可用。

有几种不同方式，用户可能会启动与 Siri 的对话：

- 通过选取设备，按主页按钮。 在这种情况下使用 Siri 将提供更多 visual 接口和较少口头响应。
- 通过说 *"您好 Siri"* 和启动手中可用的会话。 在此情况下使用 Siri 将不太 visual 并更文字。
- 使用可访问性功能，例如蓝牙启用听力帮助 UI 将针对具有特殊需求的用户。
- 使用汽车播放用户需要保留其关注侧重于通过将保持在最低限度的干扰驱动。

### <a name="how-the-developer-helps-siri"></a>开发人员如何帮助使用 Siri

当将应用与使用 Siri 集成，开发人员需要测试通常此集成，并确保它们通过尽可能在寻找任意多个不同的方式相同的信息或任务使许多不同的请求。

由于没有两人员思考相似，很重要，开发人员获取尽可能多的不同 beta 测试人员，以帮助微调 Siri 集成。 用户可能会要求有关信息或使请求方式开发人员永远不会通过的和此优化可帮助确保最广泛的用户组具有极佳体验其应用程序使用 Siri。

在不同情况和环境中测试。 启动对话与在所有可能以确保这些会话保持流体和自然的方式使用 Siri。 测试在其中用户将多个可能会使用应用程序中，如在拥挤体育馆中的位置。

请确保应用程序提供的所有信息 Siri 需要正确表示用户的请求和结果。 这在手中可用的情况下使用 Siri 时尤其如此。

### <a name="siri-design-guidelines"></a>Siri 设计准则

始终请记住，使用 Siri 与之进行对话用户的名义运行的应用程序。 流畅地自然尽可能，开发人员的想要将是不确定此会话保持。

就像与任何重要的会话，开发人员需要确保以下各项：

- 则会将应用程序准备好为会话。
- 应用程序侦听到完全哪些用户正在尝试完成。
- 应用程序在合适的时间要求相应的问题。
- 查找用户的信息的请求作出响应应用程序。

#### <a name="preparing-for-the-conversation"></a>为会话做好准备

首先要记住的是应用程序的用户不会为与开发人员完全一样。 它们可能来自从不同的背景，讲不同语言或使用应用程序时有特殊需求。

此外，开发人员而设计和构建应用程序，因为它们深，具有精通的应用程序和其内部工作情况和典型的用户不会的函数。 因此开发人员可能会不同于普通用户要求请求使用 Siri。

这是非常关键具有许多不同的人尽可能与通过使用 Siri 应用进行交互的原因。 用户可能会使开发人员具有永远不会认为的或在开发人员未考虑的方面的 Siri 通过应用程序的请求。

#### <a name="ensure-the-app-is-a-good-listener"></a>确保应用程序是一个很好的侦听器

开发人员需要确保应用程序是一个很好的侦听器，并获取满足用户期望会话的详细信息。 但是，还有可能，它们可能没有提供所有应用程序所需实现请求的任务的信息。

有多种应用程序无法处理这种情况：

- **为缺失值选取一个好的默认**-例如共享应用程序的持续一段时间可能默认为当前用户的位置，如果他们没有指定他们想要从选取。
- **作出猜测**-通过使用特定应用程序已在用户收集的信息，应用程序可能能够品牌和猜测的缺少的信息，如填写缺少移动电话号码中的用户的联系人信息。 但是，应格外小心以避免错误的意外事件，如选取最高的选项，等等。
- **提示输入更多信息**-应用程序可以使用 Siri 提示用户输入缺少的值。 但是，此处的关键简单和到点保持对话。 用户将很快沮丧如果他们需要回答几个问题需要实现其请求。
- **错误信息适当地处理**-用户可能会提供一个不需要的应用程序或它不能处理给定的上下文中的值。 确保应用程序相关方式使它清除和他们可以方便地更正中的用户这种情况。

当使用单个值的问题，无法确定应用程序，处理这种情况的首选的方法是具有 Siri 要求用户确认。 例如， *"您的意思 Bobo 出色？"*，其中他们可以使用一个简单的是或否答案回复。

如果有多个可能的选项可能是正确的单个值的情况下，消除歧义将是首选的处理方法。 在此情况下使用 Siri 可以提示用户与最多十个可能的选项可供选择。 例如：

```csharp
Who do you want to send the message to?

* Bobo the Great!
* Bobo Jr.
* Little Bobo
```

仍在问题，如果具有使用 Siri 提示用户在给定的值提供一个全新的、 更具针对性的答案。

#### <a name="request-final-confirmation"></a>请求最终确认

该应用程序实际执行任务，从而满足用户的请求之前，使用 Siri 将检查与应用扩展，以确保所有内容已到位。 例如，该用户是否具有足够的钱在其帐户，以便完成请求一次付款？

此外，应用程序需要确保，它会向所有可能的信息到 Siri 以便它可将其呈现给用户，并确认要执行的任务满足他们的期望。

一旦用户确认请求和应用程序在执行它，以再次确保它已提供的所有结果返回到 Siri 以便它可以将它们关联到用户的应用程序需求。

#### <a name="responding-to-the-request"></a>对请求作出响应

Siri 具有每个域和它所知道的操作的几个内置的用户界面。 但是，在适当的情况的应用程序可提供自定义的意向 UI 扩展来丰富用户体验，通过提供应用程序的品牌和 UI 或不是请求中存在的详细信息。

也就是说，为 Siri 设计自定义接口时，应使用挡板。 通常情况下，用户想要获取尽可能快地完成特定任务，并且不想要重载的不必要的信息。

此外必须小心以确保自定义 UI 查找，并能正确响应中的所有不同的 iOS 设备和用户可能具有或可使用该设备的方向。

如果合适的话，使用 SiriKit API 隐藏默认 Siri UI 中已存在任何冗余信息。 尚未确保，应用程序仍提供信息到 Siri 以便它可以将其呈现通过口头方式在手中可用的情况下。

可能情况下使用 Siri 将在其中启动应用程序以满足用户的请求，如提供用户已请求的照片。 在这些情况下，不用户意外的结果。 显示所期望的信息，而无中间步骤或进一步交互所需的操作。 永远不会显示信息或执行用户并不需要的任务。

### <a name="polishing-the-design"></a>改进设计

有几个 Apple 建议以优化会话的接口的设计的步骤。 首先，是通过提供清晰、 简洁的词汇和使用区分大小的示例使用 Siri。

用户发现应用程序的方式之一是通过启动与 Siri 和要求时，对话 *"可以做什么？"* Siri 将显示几个不同的事物，它可以执行的包括开发人员应用程序和示例英雄用例，它通过提供其`plist`文件。

如何编写很好的示例用例：

- 确保这些示例包括应用程序名称。
- 保留短期和点到示例。
- 为每个应用程序支持的方式提供多个示例。
- 设置优先级意向和在其中基于应用程序最常见的使用情况的示例。
- 确保应用程序提供本地化的示例。
- 请确保按预期在应用内给定 works 每个示例。
- 避免在示例中，因此，不包含文本，如寻址 Siri *"您好 Siri..."*
- 如避免任何不必要的 pleasantries *"请"* 或 *"谢谢"*。

需要适当的时间才能浏览，尝试如何应用程序可以形成 Siri 遇到其代表用户的会话。 请确保与典型的用户，在整个过程中，作为与他们之间的交互和应用程序的预期会随时间变化。

始终请记住，若要测试不同的情况下应用和所有不同的方法来调用与 Siri 的对话。 测试在现实世界位置的用户可能使用应用程序中的，从 office 和支持。

尽可能具有对话与使用 Siri （代表的应用程序） 是流体、 自然和"认为身"。 

## <a name="summary"></a>总结

本文已覆盖使用 SiriKit 所必需的显示它可以与 Xamarin.iOS 应用程序，以提供的 iOS 设备上使用 Siri 和映射的应用程序的用户可以访问的服务进行交互的关键概念。




## <a name="related-links"></a>相关链接

- [ElizaChat 示例](https://developer.xamarin.com/samples/monotouch/ios10/ElizaChat/)
- [SiriKit 编程指南](https://developer.apple.com/library/prerelease/content/documentation/Intents/Conceptual/SiriIntegrationGuide/index.html)
- [意向 Framework 参考](https://developer.apple.com/reference/intents)
- [意向 UI Framework 参考](https://developer.apple.com/reference/intentsui)
